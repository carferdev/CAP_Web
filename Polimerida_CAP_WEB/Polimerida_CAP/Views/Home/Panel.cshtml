@model Polimerida_CAP.Models.PanelViewModel
@{
    ViewData["Title"] = "Panel de Asistencia";
}

<!-- Estadísticas Generales -->
<div class="row mb-4">
    <div class="col-12">
        <h2 class="text-center mb-4">Panel de Control - Asistencia</h2>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12 col-sm-6 col-md-3">
        <div class="info-box bg-success">
            <span class="info-box-icon"><i class="fas fa-user-check"></i></span>
            <div class="info-box-content">
                <span class="info-box-text">Presentes Hoy</span>
                <span class="info-box-number">@Model.EmpleadosPresentes</span>
                <div class="progress">
                    <div class="progress-bar" style="width: @Model.PorcentajeAsistencia%"></div>
                </div>
                <span class="progress-description">
                    @Model.PorcentajeAsistencia.ToString("F1")% de asistencia
                </span>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-md-3">
        <div class="info-box bg-danger">
            <span class="info-box-icon"><i class="fas fa-user-times"></i></span>
            <div class="info-box-content">
                <span class="info-box-text">Ausentes</span>
                <span class="info-box-number">@Model.EmpleadosAusentes</span>
                <div class="progress">
                    <div class="progress-bar" style="width: 100%"></div>
                </div>
                <span class="progress-description">
                    Sin justificación
                </span>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-md-3">
        <div class="info-box bg-warning">
            <span class="info-box-icon"><i class="fas fa-file-alt"></i></span>
            <div class="info-box-content">
                <span class="info-box-text">Justificados</span>
                <span class="info-box-number">@Model.EmpleadosJustificados</span>
                <div class="progress">
                    <div class="progress-bar" style="width: 100%"></div>
                </div>
                <span class="progress-description">
                    Con justificación
                </span>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-6 col-md-3">
        <div class="info-box bg-info">
            <span class="info-box-icon"><i class="fas fa-users"></i></span>
            <div class="info-box-content">
                <span class="info-box-text">Total Empleados</span>
                <span class="info-box-number">@Model.TotalEmpleados</span>
                <div class="progress">
                    <div class="progress-bar" style="width: 100%"></div>
                </div>
                <span class="progress-description">
                    Empleados registrados
                </span>
            </div>
        </div>
    </div>
</div>

<!-- Estadísticas por Departamentos -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-building mr-2"></i>
                    Estadísticas por Departamentos
                </h3>
            </div>
            <div class="card-body">
                <div class="row">
                    @foreach (var dept in Model.EstadisticasPorDepartamento)
                    {
                        <div class="col-12 col-md-6 col-lg-4 mb-3">
                            <div class="card border-left-primary">
                                <div class="card-body">
                                    <h5 class="card-title">@dept.NombreDepartamento</h5>
                                    <div class="row text-center">
                                        <div class="col-4">
                                            <div class="text-success">
                                                <i class="fas fa-user-check"></i>
                                                <div class="h5 mb-0">@dept.Presentes</div>
                                                <small>Presentes</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="text-danger">
                                                <i class="fas fa-user-times"></i>
                                                <div class="h5 mb-0">@dept.Ausentes</div>
                                                <small>Ausentes</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="text-warning">
                                                <i class="fas fa-file-alt"></i>
                                                <div class="h5 mb-0">@dept.Justificados</div>
                                                <small>Justificados</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="progress mt-2">
                                        <div class="progress-bar bg-success" style="width: @dept.PorcentajeAsistencia%">
                                            @dept.PorcentajeAsistencia.ToString("F1")%
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Estadísticas por Grupos -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-layer-group mr-2"></i>
                    Estadísticas por Grupos
                </h3>
            </div>
            <div class="card-body">
                <div class="row">
                    @foreach (var grupo in Model.EstadisticasPorGrupo)
                    {
                        <div class="col-12 col-md-6 col-lg-4 mb-3">
                            <div class="card border-left-success">
                                <div class="card-body">
                                    <h5 class="card-title">@grupo.NombreGrupo</h5>
                                    <div class="row text-center">
                                        <div class="col-4">
                                            <div class="text-success">
                                                <i class="fas fa-user-check"></i>
                                                <div class="h5 mb-0">@grupo.Presentes</div>
                                                <small>Presentes</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="text-danger">
                                                <i class="fas fa-user-times"></i>
                                                <div class="h5 mb-0">@grupo.Ausentes</div>
                                                <small>Ausentes</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="text-warning">
                                                <i class="fas fa-file-alt"></i>
                                                <div class="h5 mb-0">@grupo.Justificados</div>
                                                <small>Justificados</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="progress mt-2">
                                        <div class="progress-bar bg-success" style="width: @grupo.PorcentajeAsistencia%">
                                            @grupo.PorcentajeAsistencia.ToString("F1")%
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Dispositivos Activos -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-desktop mr-2"></i>
                    Dispositivos Activos
                </h3>
            </div>
            <div class="card-body">
                <div class="row">
                    @foreach (var dispositivo in Model.DispositivosActivos)
                    {
                        <div class="col-12 col-md-6 col-lg-4 mb-3">
                            <div class="card border-left-info">
                                <div class="card-body">
                                    <h5 class="card-title">@dispositivo.NombreDispositivo</h5>
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="text-info">
                                                <i class="fas fa-network-wired"></i>
                                                <div class="h6 mb-0">@dispositivo.Ip</div>
                                                <small>IP</small>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="text-success">
                                                <i class="fas fa-users"></i>
                                                <div class="h6 mb-0">@dispositivo.EmpleadosRegistrados</div>
                                                <small>Empleados</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-2">
                                        <span class="badge badge-@(dispositivo.Estado ? "success" : "danger")">
                                            <i class="fas fa-circle"></i>
                                            @(dispositivo.Estado ? "Activo" : "Inactivo")
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Últimas Incidencias de Empleados -->
@if (Model.UltimasIncidenciasEmpleados.Any())
{
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Últimas Incidencias de Empleados
                    </h3>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Empleado</th>
                                    <th>Incidencia</th>
                                    <th>Fecha Inicio</th>
                                    <th>Fecha Fin</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var incidencia in Model.UltimasIncidenciasEmpleados)
                                {
                                    <tr>
                                        <td>
                                            <strong>@incidencia.NombreEmpleado</strong>
                                        </td>
                                        <td>
                                            <span class="badge badge-warning">
                                                @incidencia.DescripcionIncidencia
                                            </span>
                                        </td>
                                        <td>@incidencia.FechaInicio.ToString("dd/MM/yyyy")</td>
                                        <td>@incidencia.FechaFin.ToString("dd/MM/yyyy")</td>
                                        <td>
                                            <span class="badge badge-@(incidencia.RegStatus == "A" ? "success" : "secondary")">
                                                @(incidencia.RegStatus == "A" ? "Activa" : "Inactiva")
                                            </span>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

